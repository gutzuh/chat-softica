<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat LAN - Sistema de Mensagens</title>
    <meta name="description" content="Sistema de chat em tempo real para comunica√ß√£o em rede local">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css?v=5">
</head>
<body>
    <!-- Tela de Login -->
    <div id="login-screen" class="screen active">
        <div class="login-container">
            <div class="login-header">
                <div class="logo-icon">üí¨</div>
                <!-- Hidden logo for theme extraction (replace with your logo file) -->
                <img id="app-logo" src="logo.png" alt="logo" style="display:none;"/>
                <h1>Softica Chat</h1>
                <p>Chat Para Trabalho (E enrolar servi√ßo)</p>
            </div>
            
            <form id="login-form" class="login-form">
                <!-- Preview do avatar na tela de login -->
                <div class="login-avatar-preview" id="login-avatar-container">
                    <div class="login-avatar" id="login-avatar" title="Clique para escolher foto">
                        <span id="login-avatar-initial">?</span>
                    </div>
                    <input type="file" id="login-avatar-input" accept="image/png,image/jpeg,image/webp,image/gif" style="display:none;" />
                    <span class="login-avatar-label">Clique para escolher foto</span>
                </div>
                
                <div class="input-group">
                    <label for="username">Nome de Usu√°rio</label>
                    <input 
                        type="text" 
                        id="username" 
                        placeholder="Digite seu nome..." 
                        required 
                        autocomplete="off"
                        maxlength="20"
                    >
                </div>
                <button type="submit" class="btn-primary">
                    <span>Entrar no Chat</span>
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M4 10h12m0 0l-4-4m4 4l-4 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
            </form>
            
            <div class="login-footer">
                <p>Sistema de comunica√ß√£o em tempo real</p>
            </div>
        </div>
    </div>

    <!-- Tela Principal do Chat -->
    <div id="chat-screen" class="screen">
        <div class="chat-container">
            <!-- Sidebar com usu√°rios online -->
            <aside class="sidebar">
                <div class="sidebar-header">
                    <h2>Usu√°rios Online</h2>
                    <span id="user-count" class="user-count">0</span>
                </div>
                
                <div id="users-list" class="users-list">
                    <!-- Lista de usu√°rios ser√° inserida aqui -->
                </div>
                
                <div class="sidebar-footer">
                    <div class="current-user">
                        <div class="user-avatar" id="current-user-avatar" title="Clique para mudar avatar" style="cursor: pointer; transition: all 0.2s ease;">
                            <span id="current-user-initial">U</span>
                        </div>
                        <input type="file" id="avatar-input" accept="image/png,image/jpeg,image/webp" style="display:none;" />
                        <div class="user-info">
                            <span id="current-username" class="username">Usu√°rio</span>
                            <span class="status">Online</span>
                        </div>
                    </div>
                    <button id="logout-btn" class="btn-logout" title="Sair">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <path d="M13 3h3a2 2 0 012 2v10a2 2 0 01-2 2h-3M8 15l-5-5m0 0l5-5m-5 5h12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                </div>
            </aside>

            <!-- √Årea principal do chat -->
            <main class="chat-main">
                <header class="chat-header">
                    <div class="chat-title">
                        <h1>Chat Geral</h1>
                        <p id="typing-indicator" class="typing-indicator"></p>
                    </div>
                    <div class="header-actions">
                        <button id="theme-btn" class="btn-theme" title="Mudar Tema">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path d="M10 2a8 8 0 100 16 8 8 0 000-16zM10 4a6 6 0 016 6 6 6 0 01-6 6V4z" fill="currentColor"/>
                            </svg>
                            <span>Tema</span>
                        </button>
                        <button id="clear-chat-btn" class="btn-clear-chat" title="Limpar Chat" style="display: none;">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path d="M3 6h14M8 6V4a1 1 0 011-1h2a1 1 0 011 1v2m3 0v10a2 2 0 01-2 2H7a2 2 0 01-2-2V6h10z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span>Limpar Chat</span>
                        </button>
                        <button id="clear-db-btn" class="btn-clear-db" title="Limpar Banco de Dados" style="display: none;">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path d="M4 4h12M4 4v12a2 2 0 002 2h8a2 2 0 002-2V4M4 4l1-2h10l1 2M8 8v6M12 8v6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span>Limpar BD</span>
                        </button>
                        <button id="addons-btn" class="btn-addons" title="Addons">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path d="M10 2L2 7l8 5 8-5-8-5zM2 17l8 5 8-5M2 12l8 5 8-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span>Addons</span>
                        </button>
                        <div class="connection-status">
                            <span id="connection-dot" class="status-dot connected"></span>
                            <span id="connection-text">Conectado</span>
                        </div>
                    </div>
                </header>

                <div id="messages-container" class="messages-container">
                    <div class="welcome-message">
                        <div class="welcome-icon">üëã</div>
                        <h3>Bem-vindo ao Chat!</h3>
                        <p>Comece a conversar com seus colegas de trabalho</p>
                    </div>
                    <!-- Mensagens ser√£o inseridas aqui -->
                </div>

                <footer class="chat-footer">
                    <form id="message-form" class="message-form">
                        <div class="input-wrapper">
                            <button type="button" class="btn-sticker" id="sticker-btn" title="Enviar figurinha">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                                    <path d="M8 14s1.5 2 4 2 4-2 4-2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                    <circle cx="9" cy="9" r="1" fill="currentColor"/>
                                    <circle cx="15" cy="9" r="1" fill="currentColor"/>
                                </svg>
                            </button>
                            <button type="button" class="btn-image" id="image-btn" title="Enviar imagem">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                                    <rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/>
                                    <circle cx="8.5" cy="8.5" r="1.5" fill="currentColor"/>
                                    <path d="M21 15l-5-5L5 21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                            <input 
                                type="file" 
                                id="image-input" 
                                accept="image/jpeg,image/png,image/gif,image/webp,video/mp4,video/webm,video/avi,video/quicktime,video/x-matroska"
                                style="display: none;"
                            >
                            <button type="button" class="btn-file" id="file-btn" title="Enviar arquivo">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                                    <path d="M13 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V9z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M13 2v7h7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                            <input 
                                type="file"
                                id="file-input"
                                style="display: none;"
                            >
                            <input 
                                type="text" 
                                id="message-input" 
                                placeholder="Digite sua mensagem..." 
                                autocomplete="off"
                                maxlength="500"
                            >
                            <button type="submit" class="btn-send" id="send-btn">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                                    <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                        </div>
                    </form>
                    
                    <!-- Painel de Figurinhas -->
                    <div id="sticker-picker" class="sticker-picker" style="display: none;">
                        <div class="sticker-header">
                            <h3>Figurinhas</h3>
                            <button class="btn-close-sticker" id="close-sticker-btn">‚úï</button>
                        </div>
                        <div class="sticker-search">
                            <input 
                                type="text" 
                                id="sticker-search-input" 
                                placeholder="üîç Buscar emoji..."
                                autocomplete="off"
                            >
                        </div>
                        <div class="sticker-tabs">
                            <button class="sticker-tab active" data-category="emotions">üòä Emo√ß√µes</button>
                            <button class="sticker-tab" data-category="reactions">üëç Rea√ß√µes</button>
                            <button class="sticker-tab" data-category="animals">üê∂ Animais</button>
                            <button class="sticker-tab" data-category="objects">‚öΩ Objetos</button>
                            <button class="sticker-tab" data-category="custom">‚≠ê Minhas</button>
                        </div>
                        <div class="sticker-content" id="sticker-content">
                            <!-- Figurinhas ser√£o inseridas aqui -->
                        </div>
                    </div>
                </footer>
            </main>
            
            <!-- Sidebar de Addons -->
            <aside class="addons-sidebar" id="addons-sidebar">
                <div class="addons-header">
                    <h2>üß© Addons</h2>
                    <button class="btn-close-addons" id="close-addons-btn">‚úï</button>
                </div>
                
                <div class="addons-content">
                    <!-- Addon: Contadores -->
                    <div class="addon-section">
                        <div class="addon-section-header">
                            <h3>üìä Contadores</h3>
                            <button class="btn-new-counter" id="new-counter-btn" title="Novo contador">+</button>
                        </div>
                        
                        <div class="counters-list" id="counters-list">
                            <!-- Contadores ser√£o inseridos aqui -->
                        </div>
                    </div>

                    <!-- Addon: WhatsApp -->
                    <div class="addon-section">
                        <div class="addon-section-header">
                            <h3>üí¨ WhatsApp</h3>
                            <button id="open-whatsapp-btn" onclick="openWhatsApp()" title="Abrir WhatsApp">üì±</button>
                        </div>
                        <p style="font-size: 0.85rem; color: var(--text-secondary); padding: 0.5rem;">Integra√ß√£o com WhatsApp Web</p>
                    </div>

                </div>
            </aside>
        </div>
    </div>

    <!-- WhatsApp Screen (Full Overlay) -->
    <div id="whatsapp-screen" class="whatsapp-screen" style="display: none;">
        <div class="whatsapp-container">
            <div class="whatsapp-sidebar">
                <div class="whatsapp-header">
                    <div class="whatsapp-avatar">üë§</div>
                    <div class="whatsapp-controls">
                        <button onclick="resetWhatsApp()" title="Reiniciar Conex√£o / Gerar QR" style="margin-right: 5px; color: #ff4444;">‚Üª</button>
                        <button onclick="closeWhatsApp()" title="Fechar">‚úï</button>
                    </div>
                </div>
                <div class="whatsapp-search">
                    <input type="text" placeholder="Pesquisar ou come√ßar uma nova conversa">
                </div>
                <div class="whatsapp-contacts" id="whatsapp-contacts">
                    <!-- Lista de contatos ser√° inserida aqui -->
                    <div class="whatsapp-loading">Carregando conversas...</div>
                </div>
            </div>
            <div class="whatsapp-chat-area" id="whatsapp-chat-area">
                <div class="whatsapp-intro" id="whatsapp-intro">
                    <div class="whatsapp-intro-img">üì±</div>
                    <h2>WhatsApp Web Integration</h2>
                    <p>Envie e receba mensagens sem conectar seu celular.</p>
                    <div id="whatsapp-qr-container" style="display: none; margin-top: 2rem;">
                        <p>Escaneie o QR Code para conectar:</p>
                        <img id="whatsapp-qr-code" src="" alt="QR Code" style="width: 200px; height: 200px; border: 4px solid white;">
                    </div>
                </div>
                <div class="whatsapp-chat-main" id="whatsapp-chat-main" style="display: none;">
                    <div class="whatsapp-chat-header">
                        <div class="whatsapp-chat-avatar" id="current-chat-avatar">üë§</div>
                        <div class="whatsapp-chat-info">
                            <h3 id="current-chat-name">Nome do Contato</h3>
                            <span id="current-chat-status">online</span>
                        </div>
                    </div>
                    <div class="whatsapp-messages" id="whatsapp-messages">
                        <!-- Mensagens ser√£o inseridas aqui -->
                    </div>
                    <div class="whatsapp-input-area">
                        <input type="text" id="whatsapp-input" placeholder="Digite uma mensagem">
                    </div>
                </div>
            </div>
        </div>
    </div>
    

    <!-- Modal: Novo Contador -->
    <div id="new-counter-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Novo Contador</h3>
                <button class="modal-close" onclick="closeNewCounterModal()">‚úï</button>
            </div>
            <div class="modal-body">
                <div style="margin-bottom: 1.5rem;">
                    <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary);">Nome do contador</label>
                    <input id="counter-name" type="text" placeholder="Ex: Caf√©s tomados" style="width: 100%; padding: 0.75rem; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; color: var(--text-primary);">
                </div>
                <div style="margin-bottom: 1.5rem;">
                    <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary);">Valor inicial</label>
                    <input id="counter-initial" type="number" value="0" style="width: 100%; padding: 0.75rem; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; color: var(--text-primary);">
                </div>
                <div style="margin-bottom: 1.5rem;">
                    <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary);">Cor</label>
                    <input id="counter-color" type="color" value="#667eea" style="width: 100%; padding: 0.5rem; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; height: 40px; cursor: pointer;">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeNewCounterModal()">Cancelar</button>
                <button class="btn-secondary" style="background: linear-gradient(135deg, #ef4444 0%, #990000 100%); border: none;" onclick="createNewCounter()">Criar</button>
            </div>
        </div>
    </div>

    <!-- Modal: Sele√ß√£o de Tema -->
    <div id="theme-modal" class="modal" style="display: none;">
        <div class="modal-content theme-modal-content">
            <div class="modal-header">
                <h3>üé® Escolha um Tema</h3>
                <button class="modal-close" onclick="closeThemeModal()">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="theme-options">
                    <div class="theme-option" data-theme="default" onclick="selectTheme('default')">
                        <div class="theme-preview theme-preview-default">
                            <div class="theme-preview-header"></div>
                            <div class="theme-preview-body">
                                <div class="theme-preview-msg sent"></div>
                                <div class="theme-preview-msg received"></div>
                            </div>
                        </div>
                        <span class="theme-name">Vermelho & Preto</span>
                        <span class="theme-check">‚úì</span>
                    </div>
                    <div class="theme-option" data-theme="whatsapp" onclick="selectTheme('whatsapp')">
                        <div class="theme-preview theme-preview-whatsapp">
                            <div class="theme-preview-header"></div>
                            <div class="theme-preview-body">
                                <div class="theme-preview-msg sent"></div>
                                <div class="theme-preview-msg received"></div>
                            </div>
                        </div>
                        <span class="theme-name">WhatsApp</span>
                        <span class="theme-check">‚úì</span>
                    </div>
                    <div class="theme-option" data-theme="light" onclick="selectTheme('light')">
                        <div class="theme-preview theme-preview-light">
                            <div class="theme-preview-header"></div>
                            <div class="theme-preview-body">
                                <div class="theme-preview-msg sent"></div>
                                <div class="theme-preview-msg received"></div>
                            </div>
                        </div>
                        <span class="theme-name">Claro</span>
                        <span class="theme-check">‚úì</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Lightbox para imagens -->
    <div id="lightbox" class="lightbox">
        <div class="lightbox-content">
            <span class="lightbox-close" onclick="closeLightbox()">&times;</span>
            <img id="lightbox-img" src="" alt="">
        </div>
    </div>

    <!-- Scripts -->
    <script src="/socket.io/socket.io.js"></script>
    <script src="commands.js?v=2"></script>
    <script src="app.js?v=5"></script>
</body>
</html>
